document.addEventListener("DOMContentLoaded",()=>{asignarEventoNav(),cambiarSeccion("adornos")});let ubicacion="adornos",referenciaServicios=[],servicioAgregado=[];const contenedorCard=document.querySelector("#contenedorCard");contenedorCard.addEventListener("click",evaluarServicio);const contenedorCardResumen=document.querySelector("#contenedorCardResumen"),formulario=document.querySelector("#formulario"),seccionResumen=document.querySelector("#seccionResumen"),rutaImgErrorApi="../../build/img/error-servicios.png",rutaImgErrorForm="../../build/img/error-formulario.jpg",links=document.querySelectorAll(".navegacion .nav-item");function asignarEventoNav(){links.forEach(e=>{e.addEventListener("click",ubicacionNav)})}function ubicacionNav(e){links.forEach(e=>{e.classList.contains("active")&&e.classList.remove("active")}),e.target.classList.add("active"),ubicacion=e.target.dataset.id,cambiarSeccion(ubicacion)}function cambiarSeccion(e){document.querySelector("#tituloSeccion").textContent=e,"resumen"===e?mostrarResumen():consultarAPI(e)}async function consultarAPI(e){const n="http://localhost:3500/"+e;try{const e=await fetch(n),t=await e.json();referenciaServicios=t,pintarDatos(t)}catch(e){errores("Ouch!!","Lo sentimos, algo pasa al consultar nuestros servicios. revise su conexión a internet o intentelo más tarde. Gracias",rutaImgErrorApi)}}function pintarDatos(e){limpiarContenido(),seccionResumen.classList.add("ocultar"),contenedorCard.classList.remove("ocultar");const n=document.createDocumentFragment(),t=document.querySelector("#templateCard").content;e.forEach(e=>{const{id:o,nombre:i,piezas:a,precio:r,detalles:c}=e;t.querySelector("#cardTitulo").textContent=i,t.querySelector("#cardCantidad span").textContent=a,t.querySelector("#cardPrecio span").textContent=r,t.querySelector("#cardSeleccionar").dataset.id=o,t.querySelector("#cardDetalle span").textContent=c;const s=t.cloneNode(!0);n.appendChild(s)}),contenedorCard.appendChild(n)}function mostrarResumen(){limpiarContenido(),seccionResumen.classList.contains("ocultar")&&(seccionResumen.classList.remove("ocultar"),seccionResumen.classList.add("mostrar"),contenedorCard.classList.add("ocultar")),pintarResumen()}function pintarResumen(){const e=document.querySelector("#alertaResumen"),n=document.querySelector("#templateResumenCard").content,t=document.createDocumentFragment();if(limpiarResumen(),servicioAgregado.length<1)return e.textContent=" Aún no ha seleccionado servicios...",void document;contenedorCardResumen.addEventListener("click",acciones),e.textContent="",servicioAgregado.forEach(e=>{n.querySelector("#resumenTitulo").textContent=e.nombre,n.querySelector("#resumenDetalle span").textContent=e.detalles,n.querySelector("#resumenPiezas span").textContent=e.piezas,n.querySelector("#resumenPrecio span").textContent=e.precio,n.querySelector("#resumenCantidad span").textContent=e.cantidad,n.querySelector("#resumenPiezasTotal span").textContent=e.totalPiezas,n.querySelector("#resumenPrecioTotal span").textContent=e.totalPrecio,n.querySelector("#sumarServicio").dataset.id=e.id,n.querySelector("#removerServicio").dataset.id=e.id;const o=n.cloneNode(!0);t.appendChild(o)}),contenedorCardResumen.appendChild(t)}function evaluarServicio(e){if("cardSeleccionar"!==e.target.id)return null;const n=referenciaServicios.filter(n=>n.id===e.target.dataset.id).pop();comprobarExistencia(n)?actualizarSumarServicio(n):agregarServicioNuevo(n),notificacionMovimiento()}function comprobarExistencia(e){return!!servicioAgregado.some(n=>n.id===e.id)}function agregarServicioNuevo(e){return e.totalPrecio=e.precio,e.totalPiezas=e.piezas,servicioAgregado=[...servicioAgregado,e]}function actualizarSumarServicio(e){servicioAgregado.map(n=>(n.id===e.id&&(n.cantidad++,n.totalPrecio=n.precio*n.cantidad,n.totalPiezas=n.cantidad*n.piezas),n))}function actualizarRestarServicio(e){servicioAgregado.map(n=>{if(n.id===e.id)return n.cantidad--,n.totalPrecio=n.cantidad*n.precio,n.totalPiezas=n.cantidad*n.piezas,n}),servicioAgregado.forEach((n,t,o)=>{if(n.id===e.id&&n.cantidad<1)return servicioActualizado=o.filter(e=>0!==e.cantidad),servicioAgregado=servicioActualizado})}function notificacionMovimiento(){const e=document.querySelector("#resumen");servicioAgregado.length>0?e.classList.add("notificacion"):e.classList.remove("notificacion")}function acciones(e){let n=servicioAgregado.filter(n=>n.id===e.target.dataset.id);return n=n.pop(),"sumarServicio"===e.target.id?(actualizarSumarServicio(n),pintarResumen()):"removerServicio"===e.target.id?(actualizarRestarServicio(n),notificacionMovimiento(),pintarResumen()):void 0}function limpiarContenido(){for(;contenedorCard.firstChild;)contenedorCard.removeChild(contenedorCard.firstChild)}function limpiarResumen(){for(;contenedorCardResumen.firstElementChild;)contenedorCardResumen.removeChild(contenedorCardResumen.firstChild)}function errores(e,n,t){Swal.fire({title:e,text:n,imageUrl:t,imageWidth:400,imageHeight:200,confirmButtonText:"Entendido"})}
/*! modernizr 3.6.0 (Custom Build) | MIT *
 * https://modernizr.com/download/?-webp-setclasses !*/!function(e,n,t){function o(e,n){return typeof e===n}function i(e){var n=u.className,t=d._config.classPrefix||"";if(A&&(n=n.baseVal),d._config.enableJSClass){var o=new RegExp("(^|\\s)"+t+"no-js(\\s|$)");n=n.replace(o,"$1"+t+"js$2")}d._config.enableClasses&&(n+=" "+t+e.join(" "+t),A?u.className.baseVal=n:u.className=n)}function a(e,n){if("object"==typeof e)for(var t in e)l(e,t)&&a(t,e[t]);else{var o=(e=e.toLowerCase()).split("."),r=d[o[0]];if(2==o.length&&(r=r[o[1]]),void 0!==r)return d;n="function"==typeof n?n():n,1==o.length?d[o[0]]=n:(!d[o[0]]||d[o[0]]instanceof Boolean||(d[o[0]]=new Boolean(d[o[0]])),d[o[0]][o[1]]=n),i([(n&&0!=n?"":"no-")+o.join("-")]),d._trigger(e,n)}return d}var r=[],c=[],s={_version:"3.6.0",_config:{classPrefix:"",enableClasses:!0,enableJSClass:!0,usePrefixes:!0},_q:[],on:function(e,n){var t=this;setTimeout((function(){n(t[e])}),0)},addTest:function(e,n,t){c.push({name:e,fn:n,options:t})},addAsyncTest:function(e){c.push({name:null,fn:e})}},d=function(){};d.prototype=s,d=new d;var l,u=n.documentElement,A="svg"===u.nodeName.toLowerCase();!function(){var e={}.hasOwnProperty;l=o(e,"undefined")||o(e.call,"undefined")?function(e,n){return n in e&&o(e.constructor.prototype[n],"undefined")}:function(n,t){return e.call(n,t)}}(),s._l={},s.on=function(e,n){this._l[e]||(this._l[e]=[]),this._l[e].push(n),d.hasOwnProperty(e)&&setTimeout((function(){d._trigger(e,d[e])}),0)},s._trigger=function(e,n){if(this._l[e]){var t=this._l[e];setTimeout((function(){var e;for(e=0;e<t.length;e++)(0,t[e])(n)}),0),delete this._l[e]}},d._q.push((function(){s.addTest=a})),d.addAsyncTest((function(){function e(e,n,t){function o(n){var o=!(!n||"load"!==n.type)&&1==i.width;a(e,"webp"===e&&o?new Boolean(o):o),t&&t(n)}var i=new Image;i.onerror=o,i.onload=o,i.src=n}var n=[{uri:"data:image/webp;base64,UklGRiQAAABXRUJQVlA4IBgAAAAwAQCdASoBAAEAAwA0JaQAA3AA/vuUAAA=",name:"webp"},{uri:"data:image/webp;base64,UklGRkoAAABXRUJQVlA4WAoAAAAQAAAAAAAAAAAAQUxQSAwAAAABBxAR/Q9ERP8DAABWUDggGAAAADABAJ0BKgEAAQADADQlpAADcAD++/1QAA==",name:"webp.alpha"},{uri:"data:image/webp;base64,UklGRlIAAABXRUJQVlA4WAoAAAASAAAAAAAAAAAAQU5JTQYAAAD/////AABBTk1GJgAAAAAAAAAAAAAAAAAAAGQAAABWUDhMDQAAAC8AAAAQBxAREYiI/gcA",name:"webp.animation"},{uri:"data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA=",name:"webp.lossless"}],t=n.shift();e(t.name,t.uri,(function(t){if(t&&"load"===t.type)for(var o=0;o<n.length;o++)e(n[o].name,n[o].uri)}))})),function(){var e,n,t,i,a,s;for(var l in c)if(c.hasOwnProperty(l)){if(e=[],(n=c[l]).name&&(e.push(n.name.toLowerCase()),n.options&&n.options.aliases&&n.options.aliases.length))for(t=0;t<n.options.aliases.length;t++)e.push(n.options.aliases[t].toLowerCase());for(i=o(n.fn,"function")?n.fn():n.fn,a=0;a<e.length;a++)1===(s=e[a].split(".")).length?d[s[0]]=i:(!d[s[0]]||d[s[0]]instanceof Boolean||(d[s[0]]=new Boolean(d[s[0]])),d[s[0]][s[1]]=i),r.push((i?"":"no-")+s.join("-"))}}(),i(r),delete s.addTest,delete s.addAsyncTest;for(var m=0;m<d._q.length;m++)d._q[m]();e.Modernizr=d}(window,document);
//# sourceMappingURL=main.js.map
